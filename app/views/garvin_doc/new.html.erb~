<html>
<head>
<style type="text/css">
.imagebutton {height: 16; width: 16; border: solid 2px #69a4c4; background-color: #005EB8}
</style>
<script src="shortcut.js" type="text/javascript"></script>
<script type="text/javascript">
function start(){
	if (document.all){ 
		//IE
		frames.doc.document.designMode = "On";
	}else{ 
		//Firefox and Chrome
		document.getElementById("doc").contentDocument.designMode = "on";
		document.getElementById("doc").contentWindow.bindShortcuts();
	}
}

function runCommand(theCommand) {
	var theEditor;
		if (document.all) { 
			//IE
			frames["doc"].document.execCommand(theCommand, false);
			document.getElementById("doc").contentWindow.focus();
		} else { 
			//Firefox and Chrome
			document.getElementById("doc"
					).contentWindow.document.execCommand(theCommand, false, null);
			document.getElementById("doc").contentWindow.focus();
		}
}

function printDoc(){
	document.getElementById("docForm").action="topdf.jsp";
	document.getElementById("docForm").target="_blank";
	document.getElementById("docForm").submit();

}

function save(){
	document.getElementById("docForm").action="redirect.jsp";
	body = document.getElementById("doc").contentWindow.document.body;
	document.getElementById("newBody").value = body.innerHTML;
	document.getElementById("docForm").submit();

}

function saveAndClose(){
	body = document.getElementById("doc").contentWindow.document.body;
	document.getElementById("newBody").value = body.innerHTML;
	document.getElementById("docForm").action="redirect.jsp";
	document.getElementById("docForm").submit();
	window.close();
}
</script>
<body onload="start()" style="background-color:#177D6B;">
<form action="" id="docForm" method="post" target="">
<input type="text" id="doc_name" name="doc_name" value="" />
<table>
<tr>
<td>
<div id="bold" class="imagebutton">
<img name="bold" src="Transport_Icon_Set/text_bold.png" onclick="runCommand('bold');"/>
</div>
</td>
<td>
<div id="italic" class="imagebutton">
<img name="italic" src="Transport_Icon_Set/text_italic.png" onclick="runCommand('italic');"/>
</div>
</td>
<td>
<div id="underline" class="imagebutton">
<img name="underline" src="Transport_Icon_Set/text_underline.png" onclick="runCommand('underline');"/>
</div>
</td>
<td>
<div id="list" class="imagebutton">
<img name="list" src="Transport_Icon_Set/text_list_numbers.png" onclick="runCommand('InsertOrderedList');"/>
</div>
</td>
<td>
<div id="bullets" class="imagebutton">
<img name="bullets" src="Transport_Icon_Set/text_list_bullets.png" onclick="runCommand('InsertUnorderedList');"/>
</div>
</td>
<td>
<div id="strikethrough" class="imagebutton">
<img name="strikethrough" src="Transport_Icon_Set/text_strikethrough.png" onclick="runCommand('strikethrough');"/>
</div>
</td>
<td>
<div id="superscript" class="imagebutton">
<img name="superscript" src="Transport_Icon_Set/text_superscript.png" onclick="runCommand('superscript');"/>
</div>
</td>
<td>
<div id="subscript" class="imagebutton">
<img name="subscript" src="Transport_Icon_Set/text_subscript.png" onclick="runCommand('subscript');"/>
</div>
</td>
<td>
<div id="justifyright" class="imagebutton">
<img name="justifyright" src="Transport_Icon_Set/text_justifyright.png" onclick="runCommand('justifyright');"/>
</div>
</td>
<td>
<div id="justifycenter" class="imagebutton">
<img name="justifycenter" src="Transport_Icon_Set/text_justifycenter.png" onclick="runCommand('justifycenter');"/>
</div>
</td>
<td>
<div id="justifyleft" class="imagebutton">
<img name="justifyleft" src="Transport_Icon_Set/text_justifyleft.png" onclick="runCommand('justifyleft');"/>
</div>
</td>
<td>
<div id="justifyfull" class="imagebutton">
<img name="justifyfull" src="Transport_Icon_Set/text_justifyfull.png" onclick="runCommand('justifyfull');"/>
</div>
</td>
<td>
<div id="print" class="imagebutton">
<img name="print" src="Transport_Icon_Set/printer.png" onclick="printDoc();"/>
</div>
</td>

</tr>
</table>
<iframe src="<%= url_for(:action => 'show') %>" name="doc" id="doc" width="100%" height="90%" frameborder="1">
</iframe> 
<input type="hidden" id="newBody" name="newBody" value="Default Value Here" />
<input type="button" value="Save" onclick="save()" />
<input type="button" value="Save & Close" onclick="saveAndClose()" />
</form>
</body>
</html>